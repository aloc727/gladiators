<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gladiators Clan War Stats</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg?v=3">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="brand">
                <img src="/logo.svg?v=3" alt="Gladiators logo" class="brand-logo">
                <div class="brand-text">
                    <h1>Gladiators Clan War Stats</h1>
                    <p class="clan-tag">Clan Tag: #2CPPJLJ</p>
                </div>
            </div>
            <div class="hero-art" aria-hidden="true">
                <svg viewBox="0 0 220 80" role="presentation">
                    <defs>
                        <linearGradient id="crown" x1="0" x2="1" y1="0" y2="1">
                            <stop offset="0%" stop-color="#f7c948"/>
                            <stop offset="100%" stop-color="#f4b400"/>
                        </linearGradient>
                    </defs>
                    <path d="M20 60 L40 20 L60 50 L90 18 L120 50 L140 20 L160 60 Z" fill="url(#crown)"/>
                    <rect x="20" y="60" width="140" height="12" rx="6" fill="#203a87"/>
                    <circle cx="40" cy="20" r="6" fill="#fef3c7"/>
                    <circle cx="90" cy="18" r="6" fill="#fef3c7"/>
                    <circle cx="140" cy="20" r="6" fill="#fef3c7"/>
                </svg>
            </div>
            <p class="last-updated" id="lastUpdated">Updated as of: --</p>
        </header>

        <section class="highlights" id="highlights"></section>

        <section class="dashboard">
            <div class="dashboard-card" id="clanStats"></div>
            <div class="dashboard-card" id="promotionBoard"></div>
            <div class="dashboard-card" id="demotionBoard"></div>
            <div class="dashboard-card" id="strategyBoard"></div>
        </section>

        <div class="legend">
            <span class="legend-item legend-green">1600+ (On Track)</span>
            <span class="legend-item legend-yellow">800–1599 (Needs Push)</span>
            <span class="legend-item legend-red">0–799 (At Risk)</span>
            <span class="legend-item legend-na">N/A (New This Week)</span>
        </div>

        <div class="tabs">
            <button class="tab-button active" data-view="recent">Recent (Last 2 Months)</button>
            <button class="tab-button" data-view="all">All Time</button>
            <label class="member-toggle">
                <input type="checkbox" id="currentMembersOnly" checked>
                Show current members only
            </label>
        </div>
        
        <div class="controls">
            <div class="loading" id="loading" style="display: none;">Loading...</div>
            <span class="next-refresh" id="nextRefresh">Next refresh in: --</span>
        </div>
        
        <div class="table-container">
            <table id="statsTable">
                <thead id="tableHead">
                    <tr>
                        <th class="sortable" data-column="player">Player Name</th>
                        <!-- Week columns will be dynamically added here -->
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Data will be dynamically added here -->
                </tbody>
            </table>
        </div>
        
        <div id="errorMessage" class="error" style="display: none;"></div>

        <section class="info-section">
            <div class="info-card">
                <h3>How This Updates</h3>
                <p>The site auto-refreshes every 5 minutes and shows the latest war points. Clan wars end Sundays at 4:30am CT.</p>
            </div>
            <div class="info-card">
                <h3>Data Source</h3>
                <p>Official Clash Royale API. While the war log endpoint is down, we use the current river race data and build history locally.</p>
            </div>
            <div class="info-card">
                <h3>War Requirements</h3>
                <p>Weekly requirement is <strong>1600</strong>. New members show <strong>N/A</strong> for past weeks; non-participation shows <strong>0</strong>.</p>
            </div>
        </section>
    </div>
    
    <script src="app.js"></script>
</body>
</html>
